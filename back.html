<!DOCTYPE html>
<html>
  <head>
    <style>
      .container {
        position: relative;
        width: 600px;
        height: 600px;
        margin: 50px auto;
      }
      
      .grid-wrapper {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      
      svg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }
    
      .grid-cell {
        position: absolute;
        width: 100px;
        height: 100px;
        border: 1px solid #333;
        box-sizing: border-box;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #f0f0f0;
        transition: transform 0.3s ease;
      }

      .grid-cell:hover {
        transform: scale(1.1);
       
        z-index: 1;
      }

      .grid-cell.selected {
        background-color: #99d199;
        color: white;
      }

      .direction-button {
        position: absolute;
        width: 12px;
        height: 12px;
        background-color: #666;
        border: none;
        border-radius: 50%;
        padding: 0;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .direction-button:hover {
        background-color: #333;
      }

      .top-button {
        top: 2px;
        left: 50%;
        transform: translateX(-50%);
      }

      .bottom-button {
        bottom: 2px;
        left: 50%;
        transform: translateX(-50%);
      }

      .left-button {
        left: 2px;
        top: 50%;
        transform: translateY(-50%);
      }

      .right-button {
        right: 2px;
        top: 50%;
        transform: translateY(-50%);
      }

      /* Generate 5x5 grid using transform with 20px gutters */
      .grid-cell:nth-child(1) { transform: translate(0%, 0%); }
      .grid-cell:nth-child(2) { transform: translate(120%, 0%); }
      .grid-cell:nth-child(3) { transform: translate(240%, 0%); }
      .grid-cell:nth-child(4) { transform: translate(360%, 0%); }
      .grid-cell:nth-child(5) { transform: translate(480%, 0%); }
      
      .grid-cell:nth-child(6) { transform: translate(0%, 120%); }
      .grid-cell:nth-child(7) { transform: translate(120%, 120%); }
      .grid-cell:nth-child(8) { transform: translate(240%, 120%); }
      .grid-cell:nth-child(9) { transform: translate(360%, 120%); }
      .grid-cell:nth-child(10) { transform: translate(480%, 120%); }
      
      .grid-cell:nth-child(11) { transform: translate(0%, 240%); }
      .grid-cell:nth-child(12) { transform: translate(120%, 240%); }
      .grid-cell:nth-child(13) { transform: translate(240%, 240%); }
      .grid-cell:nth-child(14) { transform: translate(360%, 240%); }
      .grid-cell:nth-child(15) { transform: translate(480%, 240%); }
      
      .grid-cell:nth-child(16) { transform: translate(0%, 360%); }
      .grid-cell:nth-child(17) { transform: translate(120%, 360%); }
      .grid-cell:nth-child(18) { transform: translate(240%, 360%); }
      .grid-cell:nth-child(19) { transform: translate(360%, 360%); }
      .grid-cell:nth-child(20) { transform: translate(480%, 360%); }
      
      .grid-cell:nth-child(21) { transform: translate(0%, 480%); }
      .grid-cell:nth-child(22) { transform: translate(120%, 480%); }
      .grid-cell:nth-child(23) { transform: translate(240%, 480%); }
      .grid-cell:nth-child(24) { transform: translate(360%, 480%); }
      .grid-cell:nth-child(25) { transform: translate(480%, 480%); }
    </style>
  </head>
  <body>
    <div class="container">
      <svg viewBox="0 0 600 600" stroke="#000" fill="#000" stroke-width="3"
        id="svg"></svg>
      <div class="grid-wrapper">
        <div class="grid-cell" id="cell-1">
          1
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>

        <div class="grid-cell" id="cell-2">
          2
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-3">
          3
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-4">
          4
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-5">
          5
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-6">
          6
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-7">
          7
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-8">
          8
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-9">
          9
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-10">
          10
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-11">
          11
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-12">
          12
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-13">
          13
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-14">
          14
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-15">
          15
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-16">
          16
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-17">
          17
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-18">
          18
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-19">
          19
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-20">
          20
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-21">
          21
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-22">
          22
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-23">
          23
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-24">
          24
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
        <div class="grid-cell" id="cell-25">
          25
          <button class="direction-button top-button"></button>
          <button class="direction-button bottom-button"></button>
          <button class="direction-button left-button"></button>
          <button class="direction-button right-button"></button>
        </div>
      </div>
    </div>
    <div style="text-align: center; margin-top: 20px;">
      <button onclick="clearArrows()">Clear Arrows</button>
    </div>
    <script type="module">
   // Global variables
let sourceCell = null;
let sourceButton = null;
let arrowCount = 0;

// Helper function to get button position coordinates
function getButtonCoordinates(button, containerRect) {
  const buttonRect = button.getBoundingClientRect();
  return {
    x: buttonRect.left - containerRect.left + buttonRect.width / 2,
    y: buttonRect.top - containerRect.top + buttonRect.height / 2
  };
}

// Get the position type of a button (top, right, bottom, left)
function getButtonPosition(button) {
  if (button.classList.contains('top-button')) return 'top';
  if (button.classList.contains('right-button')) return 'right';
  if (button.classList.contains('bottom-button')) return 'bottom';
  if (button.classList.contains('left-button')) return 'left';
  return null;
}

// Calculate control points for the curve based on button positions
function calculateControlPoints(start, end, startPos, endPos) {
  const controlPoints = [];
  const gridSize = 100; // Size of each cell
  const gap = 20; // Gap between cells

  // Calculate offset based on button positions
  function getOffset(pos) {
    switch(pos) {
      case 'top': return { dx: 0, dy: -gap };
      case 'right': return { dx: gap, dy: 0 };
      case 'bottom': return { dx: 0, dy: gap };
      case 'left': return { dx: -gap, dy: 0 };
      default: return { dx: 0, dy: 0 };
    }
  }

  const startOffset = getOffset(startPos);
  const endOffset = getOffset(endPos);

  // Add first control point based on start button position
  controlPoints.push({
    x: start.x + startOffset.dx,
    y: start.y + startOffset.dy
  });

  // Add final control point based on end button position
  controlPoints.push({
    x: end.x + endOffset.dx,
    y: end.y + endOffset.dy
  });

  return controlPoints;
}

// Draw the arrow between buttons
function drawArrowBetweenButtons(button1, button2, fromNum, toNum) {
  const svg = document.getElementById("svg");
  const containerRect = document.querySelector('.container').getBoundingClientRect();
  
  // Get coordinates of both buttons
  const start = getButtonCoordinates(button1, containerRect);
  const end = getButtonCoordinates(button2, containerRect);
  
  // Get button positions
  const startPos = getButtonPosition(button1);
  const endPos = getButtonPosition(button2);
  
  // Calculate control points for the curve
  const controlPoints = calculateControlPoints(start, end, startPos, endPos);
  
  // Create SVG group for the arrow
  const currentArrowId = ++arrowCount;
  const group = document.createElementNS("http://www.w3.org/2000/svg", "g");
  group.setAttribute("id", `arrow-${currentArrowId}`);
  group.setAttribute("data-from", fromNum);
  group.setAttribute("data-to", toNum);

  // Draw the path
  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  const pathData = `M ${start.x},${start.y} ` +
                   `C ${controlPoints[0].x},${controlPoints[0].y} ` +
                   `${controlPoints[1].x},${controlPoints[1].y} ` +
                   `${end.x},${end.y}`;
  
  path.setAttribute("d", pathData);
  path.setAttribute("fill", "none");
  path.setAttribute("stroke", "black");
  path.setAttribute("stroke-width", "2");
  
  // Add start circle
  const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
  circle.setAttribute("cx", start.x);
  circle.setAttribute("cy", start.y);
  circle.setAttribute("r", 3);
  circle.setAttribute("fill", "black");

  // Calculate angle for arrowhead
  const dx = end.x - controlPoints[1].x;
  const dy = end.y - controlPoints[1].y;
  const angle = Math.atan2(dy, dx) * 180 / Math.PI;

  // Add arrowhead
  const arrowhead = document.createElementNS("http://www.w3.org/2000/svg", "polygon");
  arrowhead.setAttribute("points", "0,-4 8,0 0,4");
  arrowhead.setAttribute("transform", `translate(${end.x},${end.y}) rotate(${angle})`);
  arrowhead.setAttribute("fill", "black");

  // Add elements to group
  group.appendChild(path);
  group.appendChild(circle);
  group.appendChild(arrowhead);

  // Add click handler
  group.addEventListener('click', () => {
    alert(`Arrow ${currentArrowId}: from cell ${fromNum} to cell ${toNum}`);
  });

  // Add to SVG
  svg.appendChild(group);
}

// Handle button clicks
function handleButtonClick(event) {
  const clickedButton = event.target;
  const clickedCell = clickedButton.closest('.grid-cell');
  
  if (!sourceButton) {
    sourceButton = clickedButton;
    sourceCell = clickedCell;
    sourceCell.classList.add('selected');
  } else {
    const fromNum = parseInt(sourceCell.id.split('-')[1]);
    const toNum = parseInt(clickedCell.id.split('-')[1]);
    drawArrowBetweenButtons(sourceButton, clickedButton, fromNum, toNum);
    sourceCell.classList.remove('selected');
    sourceButton = null;
    sourceCell = null;
  }
}

// Clear all arrows
function clearArrows() {
  const svg = document.getElementById("svg");
  while (svg.firstChild) {
    svg.removeChild(svg.firstChild);
  }
  if (sourceCell) {
    sourceCell.classList.remove('selected');
    sourceCell = null;
    sourceButton = null;
  }
  arrowCount = 0;
}

// Initialize button click handlers
document.querySelectorAll('.direction-button').forEach(button => {
  button.addEventListener('click', handleButtonClick);
  button.addEventListener('click', (e) => e.stopPropagation());
});
    </script>
  </body>
</html>